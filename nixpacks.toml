# Nixpacks build config (Railway). Run Drizzle schema push before Next.js build.
# https://nixpacks.com/docs/guides/configuring-builds

[phases.setup]
nixPkgs = ["nodejs_20"]

[phases.install]
cmds = ["npm ci"]

[phases.build]
# Push schema to Postgres (skip if DATABASE_URL unset or push fails), then build
cmds = ["npm run db:push:pg || true", "npm run build"]
